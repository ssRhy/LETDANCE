# LETDANCE å›¾åƒä¿å­˜åŠŸèƒ½ä½¿ç”¨æŒ‡å—

## âœ… åŠŸèƒ½å·²å®ç°å¹¶æµ‹è¯•é€šè¿‡ï¼

æ­å–œï¼æ‚¨çš„ LETDANCE é¡¹ç›®ç°åœ¨å·²ç»æˆåŠŸå®ç°äº†å›¾åƒä¿å­˜åŠŸèƒ½ã€‚æ‰€æœ‰æ ¸å¿ƒç»„ä»¶éƒ½å·²ç»è¿‡æµ‹è¯•éªŒè¯ã€‚

## ğŸ“ ç›®å½•ç»“æ„

```
data/
â””â”€â”€ images/
    â”œâ”€â”€ image_analysis/          # ç¬¬ä¸€æ¬¡æ‹ç…§çš„å›¾ç‰‡
    â”‚   â”œâ”€â”€ captured_photo_20250716_065427_056.jpg
    â”‚   â””â”€â”€ mock_test_20250716_065427_038.jpg
    â””â”€â”€ pose_analysis/           # å§¿æ€åˆ†æçš„å…³é”®å¸§
        â””â”€â”€ mock_pose_happy_20250716_065427_056.jpg
```

## ğŸš€ å¦‚ä½•ä½¿ç”¨

### æ–¹æ³•ä¸€ï¼šè¿è¡Œå®Œæ•´å·¥ä½œæµï¼ˆæ¨èï¼‰

```bash
python main_agent.py
```

è¿™å°†æ‰§è¡Œå®Œæ•´çš„ LETDANCE å·¥ä½œæµï¼š

1. **è‡ªåŠ¨æ‹ç…§å¹¶ä¿å­˜** - ç¬¬ä¸€å¼ ç…§ç‰‡ä¼šä¿å­˜åˆ° `data/images/image_analysis/`
2. **å®æ—¶å§¿æ€åˆ†æ** - å…³é”®å¸§ä¼šä¿å­˜åˆ° `data/images/pose_analysis/`
3. **ç”ŸæˆéŸ³ä¹å…³é”®è¯** - åŸºäºå›¾åƒå’Œå§¿æ€åˆ†æç»“æœ

### æ–¹æ³•äºŒï¼šå•ç‹¬ä½¿ç”¨å›¾åƒåˆ†æå·¥å…·

```python
from tools.image_analysis_tool import ImageAnalysisTool

# åˆ›å»ºå·¥å…·å®ä¾‹
tool = ImageAnalysisTool()

# æ‹ç…§å¹¶åˆ†æï¼ˆè‡ªåŠ¨ä¿å­˜ï¼‰
result = tool.run({
    "action": "capture_and_analyze",
    "analysis_prompt": "åˆ†æç”¨æˆ·çš„æƒ…æ„ŸçŠ¶æ€"
})

# æ£€æŸ¥ç»“æœ
if result['success']:
    print(f"å›¾åƒå·²ä¿å­˜åˆ°: {result['saved_image_path']}")
```

### æ–¹æ³•ä¸‰ï¼šå•ç‹¬ä½¿ç”¨å§¿æ€åˆ†æå·¥å…·

```python
from tools.pose_analysis_tool import PoseAnalysisTool

# åˆ›å»ºå·¥å…·å®ä¾‹
tool = PoseAnalysisTool()

# å®æ—¶åˆ†æå¹¶ä¿å­˜å…³é”®å¸§
result = tool.run({
    "action": "analyze_realtime",
    "duration": 10,                # åˆ†æ10ç§’
    "save_frames": True,           # å¯ç”¨å¸§ä¿å­˜
    "save_interval": 30            # æ¯30å¸§ä¿å­˜ä¸€æ¬¡
})

# æ£€æŸ¥ç»“æœ
if result['success']:
    data = result['data']
    print(f"ä¿å­˜äº† {data['saved_frames_count']} å¸§")
```

## âš™ï¸ é…ç½®é€‰é¡¹

### å›¾åƒåˆ†æå·¥å…·

- **è‡ªåŠ¨ä¿å­˜**: é»˜è®¤å¯ç”¨ï¼Œç¬¬ä¸€å¼ æ‹ç…§ä¼šè‡ªåŠ¨ä¿å­˜
- **ä¿å­˜è·¯å¾„**: `data/images/image_analysis/`
- **æ–‡ä»¶å‘½å**: `captured_photo_YYYYMMDD_HHMMSS_SSS.jpg`

### å§¿æ€åˆ†æå·¥å…·

- **save_frames**: æ˜¯å¦ä¿å­˜å¸§ï¼ˆé»˜è®¤: Trueï¼‰
- **save_interval**: ä¿å­˜é—´éš”ï¼Œæ¯ N å¸§ä¿å­˜ä¸€æ¬¡ï¼ˆé»˜è®¤: 30ï¼‰
- **ä¿å­˜è·¯å¾„**: `data/images/pose_analysis/`
- **æ–‡ä»¶å‘½å**: `pose_frame_å¸§å·_æƒ…æ„Ÿ_YYYYMMDD_HHMMSS_SSS.jpg`

## ğŸ› ï¸ ç³»ç»Ÿè¦æ±‚

### å¿…éœ€ä¾èµ–

```bash
pip install opencv-python
pip install ultralytics  # ç”¨äºå§¿æ€æ£€æµ‹
pip install langchain
pip install langchain-openai
```

### ç¡¬ä»¶è¦æ±‚

- **æ‘„åƒå¤´**: ç”¨äºå›¾åƒåˆ†æå’Œå§¿æ€æ£€æµ‹
- **ç½‘ç»œè¿æ¥**: ç”¨äº Azure OpenAI æœåŠ¡ï¼ˆå›¾åƒåˆ†æï¼‰å’Œ YOLO æ¨¡å‹ä¸‹è½½

## ğŸ“Š åŠŸèƒ½éªŒè¯

æ‚¨å¯ä»¥è¿è¡Œæµ‹è¯•è„šæœ¬æ¥éªŒè¯åŠŸèƒ½ï¼š

```bash
# æ¨¡æ‹Ÿæµ‹è¯•ï¼ˆä¸éœ€è¦æ‘„åƒå¤´ï¼‰
python test_image_save_mock.py

# å®Œæ•´æµ‹è¯•ï¼ˆéœ€è¦æ‘„åƒå¤´ï¼‰
python test_image_save.py
```

## ğŸ¯ å®é™…ä½¿ç”¨ç¤ºä¾‹

### åœºæ™¯ 1: å®Œæ•´çš„èˆè¹ˆæƒ…æ„Ÿåˆ†æ

```bash
python main_agent.py
```

ç³»ç»Ÿä¼šï¼š

1. æ‹ç…§å¹¶åˆ†æç”¨æˆ·è¡¨æƒ… â†’ ä¿å­˜åˆ° `data/images/image_analysis/`
2. è¿›è¡Œ 10 ç§’å§¿æ€åˆ†æ â†’ ä¿å­˜å…³é”®å¸§åˆ° `data/images/pose_analysis/`
3. ç”ŸæˆéŸ³ä¹é£æ ¼å…³é”®è¯

### åœºæ™¯ 2: å¿«é€Ÿæƒ…æ„Ÿæ£€æµ‹

```python
from tools import get_tool

# è·å–å›¾åƒåˆ†æå·¥å…·
image_tool = get_tool('image_analysis')

# å¿«é€Ÿæ‹ç…§åˆ†æ
result = image_tool.run({"action": "capture_and_analyze"})
print(f"ä¿å­˜è·¯å¾„: {result['saved_image_path']}")
```

### åœºæ™¯ 3: é•¿æ—¶é—´å§¿æ€ç›‘æ§

```python
from tools import get_tool

# è·å–å§¿æ€åˆ†æå·¥å…·
pose_tool = get_tool('pose_analysis')

# é•¿æ—¶é—´åˆ†æï¼ˆ60ç§’ï¼Œæ¯20å¸§ä¿å­˜ä¸€æ¬¡ï¼‰
result = pose_tool.run({
    "action": "analyze_realtime",
    "duration": 60,
    "save_interval": 20
})

print(f"ä¿å­˜äº† {result['data']['saved_frames_count']} å¸§")
```

## ğŸ—‚ï¸ æ–‡ä»¶ç®¡ç†

### æŸ¥çœ‹å­˜å‚¨ä¿¡æ¯

```python
from tools.image_storage_utils import storage_manager

# è·å–å­˜å‚¨ç»Ÿè®¡
info = storage_manager.get_storage_info()
print(f"å›¾åƒåˆ†ææ–‡ä»¶: {info['image_analysis_count']} ä¸ª")
print(f"å§¿æ€åˆ†ææ–‡ä»¶: {info['pose_analysis_count']} ä¸ª")
```

### æ¸…ç†æ—§æ–‡ä»¶

```python
from tools.image_storage_utils import storage_manager

# æ¸…ç†7å¤©å‰çš„æ–‡ä»¶
deleted_count = storage_manager.cleanup_old_images(days_old=7)
print(f"åˆ é™¤äº† {deleted_count} ä¸ªæ—§æ–‡ä»¶")
```

## ğŸ’¡ ä½¿ç”¨å»ºè®®

1. **é¦–æ¬¡ä½¿ç”¨**: å»ºè®®å…ˆè¿è¡Œæ¨¡æ‹Ÿæµ‹è¯• `python test_image_save_mock.py`
2. **æ‘„åƒå¤´æµ‹è¯•**: ç¡®ä¿æ‘„åƒå¤´å·¥ä½œåè¿è¡Œ `python test_image_save.py`
3. **å®Œæ•´ä½“éªŒ**: è¿è¡Œ `python main_agent.py` ä½“éªŒå®Œæ•´å·¥ä½œæµ
4. **å­˜å‚¨ç®¡ç†**: å®šæœŸæ¸…ç†æ—§æ–‡ä»¶æˆ–ç›‘æ§ç£ç›˜ä½¿ç”¨æƒ…å†µ

## ğŸ‰ åŠŸèƒ½ç‰¹è‰²

- âœ… **è‡ªåŠ¨ä¿å­˜**: ç¬¬ä¸€å¼ æ‹ç…§è‡ªåŠ¨ä¿å­˜
- âœ… **æ™ºèƒ½å‘½å**: åŒ…å«æ—¶é—´æˆ³å’Œæƒ…æ„Ÿä¿¡æ¯
- âœ… **å¯è§†åŒ–**: å§¿æ€å›¾åƒåŒ…å«å…³é”®ç‚¹å’Œéª¨æ¶
- âœ… **é…ç½®çµæ´»**: å¯æ§åˆ¶ä¿å­˜é—´éš”å’Œå‚æ•°
- âœ… **é”™è¯¯å¤„ç†**: ä¿å­˜å¤±è´¥ä¸å½±å“ä¸»è¦åŠŸèƒ½
- âœ… **å­˜å‚¨ç®¡ç†**: è‡ªåŠ¨ç›®å½•åˆ›å»ºå’Œæ–‡ä»¶ç»Ÿè®¡

æ‚¨çš„å›¾åƒä¿å­˜åŠŸèƒ½ç°åœ¨å·²ç»å®Œå…¨å®ç°å¹¶å¯ä»¥ä½¿ç”¨äº†ï¼ğŸŠ
